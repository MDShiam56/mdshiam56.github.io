<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sign Up - NST CLUB</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@700&family=Rajdhani:wght@500;700&display=swap');
        
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body { 
            height: 100vh; 
            display: flex; 
            justify-content: center; 
            align-items: center; 
            background: #020a05; 
            font-family: 'Rajdhani', sans-serif; 
        }

        .signup-container { 
            width: 380px; padding: 40px; 
            background: rgba(15, 15, 15, 0.9); 
            border-radius: 30px; border: 1px solid #00ff88; 
            text-align: center; 
            box-shadow: 0 10px 40px rgba(0,255,136,0.2); 
            backdrop-filter: blur(10px); 
        }

        h2 { font-family: 'Orbitron'; color: #00ff88; font-size: 28px; margin-bottom: 25px; text-shadow: 0 0 10px #00ff88; }
        
        .input-field { width: 100%; margin-bottom: 15px; }
        
        .input-field input { 
            width: 100%; padding: 15px; background: #111; 
            border: 1px solid #222; border-radius: 12px; 
            color: #fff; font-size: 16px; outline: none; 
        }
        
        .input-field input:focus { 
            border-color: #00ff88; box-shadow: 0 0 10px rgba(0, 255, 136, 0.3); 
        }

        .signup-btn { 
            width: 100%; padding: 15px; 
            background: linear-gradient(45deg, #00ff88, #00ffee); 
            border: none; border-radius: 12px; 
            color: #000; font-weight: 900; 
            font-family: 'Orbitron'; cursor: pointer; transition: 0.4s; 
        }
        
        .signup-btn:hover { transform: scale(1.03); box-shadow: 0 0 20px #00ff88; }
        
        .footer { margin-top: 20px; color: #777; font-size: 14px; }
        
        .footer a { color: #00ff88; text-decoration: none; font-weight: bold; }

    </style>
</head>
<body>

    <div class="signup-container">
        <h2>SIGN UP</h2>
        <div class="input-field"><input type="text" id="name" placeholder="Full Name"></div>
        <div class="input-field"><input type="email" id="email" placeholder="Email Address"></div>
        <div class="input-field"><input type="password" id="pass" placeholder="Create Password"></div>
        <button class="signup-btn" id="regBtn">CREATE ACCOUNT</button>
        <div class="footer">Member already? <a href="login.html">Login</a></div>
    </div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/12.7.0/firebase-app.js";
        import { getAuth, createUserWithEmailAndPassword } from "https://www.gstatic.com/firebasejs/12.7.0/firebase-auth.js";
        import { getDatabase, ref, set, get, update } from "https://www.gstatic.com/firebasejs/12.7.0/firebase-database.js";

        // Firebase Configuration
        const firebaseConfig = {
            apiKey: "AIzaSyD-U5wOhyMDsiFf7NB4-twMFNnoWCXVXpE",
            authDomain: "login-52331.firebaseapp.com",
            projectId: "login-52331",
            storageBucket: "login-52331.firebasestorage.app",
            messagingSenderId: "199346485569",
            appId: "1:199346485569:web:69014a90e2031e147609c0",
            databaseURL: "https://login-52331-default-rtdb.firebaseio.com"
        };

        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const db = getDatabase(app);

        document.getElementById('regBtn').onclick = async () => {
            const name = document.getElementById('name').value.trim();
            const email = document.getElementById('email').value.trim();
            const pass = document.getElementById('pass').value.trim();
            const urlParams = new URLSearchParams(window.location.search);
            const refID = urlParams.get('ref');

            if (name && email && pass) {
                try {
                    const userCred = await createUserWithEmailAndPassword(auth, email, pass);
                    const user = userCred.user;

                    // Save user data to Realtime Database
                    await set(ref(db, 'users/' + user.uid), {
                        name: name,
                        email: email,
                        balance: 0,
                        referredBy: refID || "none",
                        totalCommission: 0,
                        referCount: 0
                    });

                    // Handle Referral Logic
                    if (refID && refID !== "none") {
                        const refUserPath = ref(db, 'users/' + refID);
                        const snap = await get(refUserPath);
                        if (snap.exists()) {
                            await update(refUserPath, {
                                balance: (snap.val().balance || 0) + 20,
                                totalCommission: (snap.val().totalCommission || 0) + 20,
                                referCount: (snap.val().referCount || 0) + 1
                            });
                        }
                    }
                    alert("Account Created Successfully!");
                    window.location.href = "index.html";
                } catch (e) { 
                    alert(e.message); 
                }
            } else { 
                alert("Please fill all fields!"); 
            }
        };
    </script>
</body>
</html>
<script>
  atOptions = {
    'key' : 'c403443c624d3a0e64d71e89cd90306b',
    'format' : 'iframe',
    'height' : 50,
    'width' : 320,
    'params' : {}
  };
</script>
<script src="https://www.highperformanceformat.com/c403443c624d3a0e64d71e89cd90306b/invoke.js"></script>
